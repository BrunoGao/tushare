<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript è°ƒè¯•é¡µé¢</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1>JavaScript åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="alert alert-info">
            <h5>è°ƒè¯•ä¿¡æ¯</h5>
            <div id="debug-info">
                <p>jQuery å¯ç”¨: <span id="jquery-status">æ£€æŸ¥ä¸­...</span></p>
                <p>Bootstrap å¯ç”¨: <span id="bootstrap-status">æ£€æŸ¥ä¸­...</span></p>
                <p>Socket.IO å¯ç”¨: <span id="socketio-status">æ£€æŸ¥ä¸­...</span></p>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <h3>åŠŸèƒ½æµ‹è¯•æŒ‰é’®</h3>
                <button class="btn btn-primary mb-2" onclick="testBasicFunction()">æµ‹è¯•åŸºæœ¬å‡½æ•°</button><br>
                <button class="btn btn-success mb-2" onclick="testNotification()">æµ‹è¯•é€šçŸ¥</button><br>
                <button class="btn btn-warning mb-2" onclick="testModal()">æµ‹è¯•æ¨¡æ€æ¡†</button><br>
                <button class="btn btn-info mb-2" onclick="testAPICall()">æµ‹è¯•APIè°ƒç”¨</button><br>
                <button class="btn btn-secondary mb-2" onclick="testSocketIO()">æµ‹è¯•Socket.IO</button><br>
            </div>
            
            <div class="col-md-6">
                <h3>ç»“æœè¾“å‡º</h3>
                <div id="test-results" style="background: #f8f9fa; padding: 15px; border-radius: 5px; min-height: 200px;">
                    ç­‰å¾…æµ‹è¯•ç»“æœ...
                </div>
            </div>
        </div>
        
        <div class="mt-4">
            <a href="/" class="btn btn-outline-primary">è¿”å›ä¸»é¡µ</a>
        </div>
    </div>

    <!-- JavaScript ä¾èµ– -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    
    <script>
        let testResults = document.getElementById('test-results');
        
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ä¾èµ–
        document.addEventListener('DOMContentLoaded', function() {
            // æ£€æŸ¥jQuery
            document.getElementById('jquery-status').textContent = 
                typeof $ !== 'undefined' ? 'âœ… å¯ç”¨' : 'âŒ ä¸å¯ç”¨';
            
            // æ£€æŸ¥Bootstrap
            document.getElementById('bootstrap-status').textContent = 
                typeof bootstrap !== 'undefined' ? 'âœ… å¯ç”¨' : 'âŒ ä¸å¯ç”¨';
            
            // æ£€æŸ¥Socket.IO
            document.getElementById('socketio-status').textContent = 
                typeof io !== 'undefined' ? 'âœ… å¯ç”¨' : 'âŒ ä¸å¯ç”¨';
            
            logResult('âœ… é¡µé¢ä¾èµ–æ£€æŸ¥å®Œæˆ');
        });
        
        function logResult(message) {
            const timestamp = new Date().toLocaleTimeString();
            testResults.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            testResults.scrollTop = testResults.scrollHeight;
        }
        
        function testBasicFunction() {
            try {
                logResult('ğŸ§ª æµ‹è¯•åŸºæœ¬JavaScriptå‡½æ•°...');
                let test = "Hello World";
                logResult('âœ… åŸºæœ¬å‡½æ•°æµ‹è¯•æˆåŠŸ: ' + test);
            } catch (error) {
                logResult('âŒ åŸºæœ¬å‡½æ•°æµ‹è¯•å¤±è´¥: ' + error.message);
            }
        }
        
        function testNotification() {
            try {
                logResult('ğŸ”” æµ‹è¯•é€šçŸ¥åŠŸèƒ½...');
                showNotification('success', 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é€šçŸ¥');
                logResult('âœ… é€šçŸ¥åŠŸèƒ½æµ‹è¯•æˆåŠŸ');
            } catch (error) {
                logResult('âŒ é€šçŸ¥åŠŸèƒ½æµ‹è¯•å¤±è´¥: ' + error.message);
            }
        }
        
        function testModal() {
            try {
                logResult('ğŸ“± æµ‹è¯•æ¨¡æ€æ¡†åŠŸèƒ½...');
                const modal = createModal('testModal', 'æµ‹è¯•æ¨¡æ€æ¡†', 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ¨¡æ€æ¡†', 
                    '<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å…³é—­</button>');
                showModal(modal);
                logResult('âœ… æ¨¡æ€æ¡†åŠŸèƒ½æµ‹è¯•æˆåŠŸ');
            } catch (error) {
                logResult('âŒ æ¨¡æ€æ¡†åŠŸèƒ½æµ‹è¯•å¤±è´¥: ' + error.message);
            }
        }
        
        async function testAPICall() {
            try {
                logResult('ğŸŒ æµ‹è¯•APIè°ƒç”¨...');
                const response = await fetch('/api/status');
                const data = await response.json();
                logResult('âœ… APIè°ƒç”¨æˆåŠŸ: ' + JSON.stringify(data, null, 2));
            } catch (error) {
                logResult('âŒ APIè°ƒç”¨å¤±è´¥: ' + error.message);
            }
        }
        
        function testSocketIO() {
            try {
                logResult('ğŸ”— æµ‹è¯•Socket.IOè¿æ¥...');
                if (typeof io !== 'undefined') {
                    const testSocket = io();
                    testSocket.on('connect', function() {
                        logResult('âœ… Socket.IOè¿æ¥æˆåŠŸ');
                    });
                    testSocket.on('connect_error', function(error) {
                        logResult('âŒ Socket.IOè¿æ¥å¤±è´¥: ' + error);
                    });
                } else {
                    logResult('âŒ Socket.IOä¸å¯ç”¨');
                }
            } catch (error) {
                logResult('âŒ Socket.IOæµ‹è¯•å¤±è´¥: ' + error.message);
            }
        }
        
        // é€šçŸ¥å‡½æ•°
        function showNotification(type, message) {
            const notification = document.createElement('div');
            const alertClass = {
                'success': 'alert-success',
                'error': 'alert-danger', 
                'warning': 'alert-warning',
                'info': 'alert-info'
            }[type] || 'alert-info';
            
            notification.className = `alert ${alertClass} position-fixed`;
            notification.style.cssText = 'top: 80px; right: 20px; z-index: 9999; min-width: 300px;';
            notification.innerHTML = `${message}`;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }
        
        // æ¨¡æ€æ¡†å‡½æ•°
        function createModal(id, title, body, footer) {
            const existingModal = document.getElementById(id);
            if (existingModal) {
                existingModal.remove();
            }
            
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            modal.id = id;
            modal.tabIndex = -1;
            modal.innerHTML = `
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">${title}</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">${body}</div>
                        <div class="modal-footer">${footer}</div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            return modal;
        }
        
        function showModal(modalElement) {
            const modal = new bootstrap.Modal(modalElement);
            modal.show();
            
            modalElement.addEventListener('hidden.bs.modal', function() {
                modalElement.remove();
            });
        }
    </script>
</body>
</html>